# Application Properties for Docker Deployment
# OVERRIDES ONLY - All other settings inherited from application.properties
#
# Activate with: SPRING_PROFILES_ACTIVE=docker

# ===================================================================
# DOCKER-SPECIFIC OVERRIDES
# ===================================================================

# Database Configuration - Use Docker host reference
# Using host.docker.internal to connect to PostgreSQL on host machine
spring.datasource.url=jdbc:postgresql://host.docker.internal:5432/AmmoP1DB
spring.datasource.username=${DB_USERNAME:postgres}

# Hibernate Configuration - Validate schema matches entities
# Setting to 'validate' checks that DB schema matches entity definitions without modifying anything
# This is safe for existing databases with data
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
# Note: NOT setting hibernate.jdbc.time_zone because we handle UTC in Java code with LocalDateTime.now(ZoneOffset.UTC)

# Spring Boot SQL Initialization - Disabled since database already exists with data
# mode=never prevents schema.sql from running (tables already exist on host DB)
# Use mode=always only for fresh containerized database deployments
spring.sql.init.mode=never
spring.sql.init.continue-on-error=false
spring.jpa.defer-datasource-initialization=false

# Error handling - Show errors for Docker debugging
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param

# Session Cookie Configuration - Allow cookies to work with IP addresses
server.servlet.session.cookie.domain=
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.same-site=lax

# Logging Configuration - More verbose for Docker debugging
logging.level.com.ammons.taskactivity=DEBUG
logging.level.com.ammons.taskactivity.config.DataInitializer=INFO
logging.level.com.ammons.taskactivity.service.CustomUserDetailsService=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.security.authentication=DEBUG
logging.level.org.springframework.security.web.authentication=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
# Log SQL script execution to verify schema.sql is running
logging.level.org.springframework.jdbc.datasource.init=DEBUG
logging.level.org.springframework.boot.autoconfigure=DEBUG

