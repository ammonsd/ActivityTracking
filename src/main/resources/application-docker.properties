# Application Properties for Docker Deployment
# OVERRIDES ONLY - All other settings inherited from application.properties
#
# Activate with: SPRING_PROFILES_ACTIVE=docker

# ===================================================================
# DOCKER-SPECIFIC OVERRIDES
# ===================================================================

# Database Configuration - Use Docker host reference
# Using host.docker.internal to connect to PostgreSQL on host machine
spring.datasource.url=jdbc:postgresql://host.docker.internal:5432/AmmoP1DB
spring.datasource.username=${DB_USERNAME:postgres}

# Hibernate Configuration - None (let schema.sql handle schema creation)
# Setting to 'none' prevents Hibernate from trying to create/validate schema
# The schema will be created by schema.sql instead
spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
# Note: NOT setting hibernate.jdbc.time_zone because we handle UTC in Java code with LocalDateTime.now(ZoneOffset.UTC)

# Spring Boot SQL Initialization - Run schema.sql to create tables
# mode=always ensures schema.sql runs on startup
# defer-datasource-initialization=false ensures schema.sql runs BEFORE Hibernate validation
# continue-on-error=false will stop if schema.sql has errors (recommended for debugging)
spring.sql.init.mode=always
spring.sql.init.continue-on-error=false
spring.jpa.defer-datasource-initialization=false

# Error handling - Show errors for Docker debugging
server.error.include-message=always
server.error.include-binding-errors=always
server.error.include-stacktrace=on_param

# Session Cookie Configuration - Allow cookies to work with IP addresses
server.servlet.session.cookie.domain=
server.servlet.session.cookie.http-only=true
server.servlet.session.cookie.secure=false
server.servlet.session.cookie.same-site=lax

# Logging Configuration - More verbose for Docker debugging
logging.level.com.ammons.taskactivity=DEBUG
logging.level.com.ammons.taskactivity.config.DataInitializer=INFO
logging.level.com.ammons.taskactivity.service.CustomUserDetailsService=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.security.authentication=DEBUG
logging.level.org.springframework.security.web.authentication=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
# Log SQL script execution to verify schema.sql is running
logging.level.org.springframework.jdbc.datasource.init=DEBUG
logging.level.org.springframework.boot.autoconfigure=DEBUG

