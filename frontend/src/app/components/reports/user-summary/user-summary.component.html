<mat-card class="user-summary-card">
  <mat-card-header>
    <mat-icon>leaderboard</mat-icon>
    <mat-card-title>User Performance Summary</mat-card-title>
    <mat-card-subtitle>Total hours worked by each user</mat-card-subtitle>
  </mat-card-header>

  <mat-card-content>
    <div *ngIf="loading" class="loading-spinner">
      <mat-spinner diameter="40"></mat-spinner>
    </div>

    <div *ngIf="!loading && userSummaries.length > 0" class="table-container">
      <table mat-table [dataSource]="userSummaries" class="user-table">
        <!-- Rank Column -->
        <ng-container matColumnDef="rank">
          <th mat-header-cell *matHeaderCellDef>Rank</th>
          <td
            mat-cell
            *matCellDef="let row; let i = index"
            [class]="getRankClass(i)"
          >
            <mat-icon class="rank-icon" [class]="getRankClass(i)">{{
              getRankIcon(i)
            }}</mat-icon>
          </td>
        </ng-container>

        <!-- Username Column -->
        <ng-container matColumnDef="username">
          <th mat-header-cell *matHeaderCellDef>User</th>
          <td mat-cell *matCellDef="let row">
            <span class="username">{{ row.username }}</span>
          </td>
        </ng-container>

        <!-- Total Hours Column -->
        <ng-container matColumnDef="totalHours">
          <th mat-header-cell *matHeaderCellDef>Total Hours</th>
          <td mat-cell *matCellDef="let row">
            <strong>{{ row.totalHours }}</strong>
          </td>
        </ng-container>

        <!-- Billable Hours Column -->
        <ng-container matColumnDef="billableHours">
          <th mat-header-cell *matHeaderCellDef>Billable</th>
          <td mat-cell *matCellDef="let row" class="billable-hours">
            {{ row.billableHours }}
          </td>
        </ng-container>

        <!-- Non-Billable Hours Column -->
        <ng-container matColumnDef="nonBillableHours">
          <th mat-header-cell *matHeaderCellDef>Non-Billable</th>
          <td mat-cell *matCellDef="let row" class="non-billable-hours" [ngStyle]="{'color': 'red', 'font-weight': 'bold'}">
            {{ row.nonBillableHours }}
          </td>
        </ng-container>

        <!-- Task Count Column -->
        <ng-container matColumnDef="taskCount">
          <th mat-header-cell *matHeaderCellDef>Tasks</th>
          <td mat-cell *matCellDef="let row">{{ row.taskCount }}</td>
        </ng-container>

        <!-- Avg Hours Per Day Column (Billable only) -->
        <ng-container matColumnDef="avgHoursPerDay">
          <th mat-header-cell *matHeaderCellDef>Avg Billable/Day</th>
          <td mat-cell *matCellDef="let row">{{ row.avgHoursPerDay }}</td>
        </ng-container>

        <!-- Top Client Column -->
        <ng-container matColumnDef="topClient">
          <th mat-header-cell *matHeaderCellDef>Top Client</th>
          <td mat-cell *matCellDef="let row">{{ row.topClient }}</td>
        </ng-container>

        <!-- Top Project Column -->
        <ng-container matColumnDef="topProject">
          <th mat-header-cell *matHeaderCellDef>Top Project</th>
          <td mat-cell *matCellDef="let row">{{ row.topProject }}</td>
        </ng-container>

        <!-- Last Activity Column -->
        <ng-container matColumnDef="lastActivityDate">
          <th mat-header-cell *matHeaderCellDef>Last Activity</th>
          <td mat-cell *matCellDef="let row">{{ row.lastActivityDate }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>

    <div *ngIf="!loading && userSummaries.length === 0" class="no-data">
      <mat-icon>info</mat-icon>
      <p>No user data available for the selected period</p>
    </div>
  </mat-card-content>
</mat-card>
