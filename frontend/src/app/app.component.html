<mat-toolbar color="primary" class="app-toolbar">
  <button mat-icon-button (click)="drawer?.toggle()">
    <mat-icon>menu</mat-icon>
  </button>
  <span class="app-title">{{ title }}</span>
  <span class="spacer"></span>
  <div class="user-info">
    <div *ngIf="passwordExpiringWarning" class="password-warning">
      {{ passwordExpiringWarning }}
    </div>
    <span class="current-user" *ngIf="authService.currentUser$ | async as username">{{ username }}</span>
    <span class="current-date">{{ currentDate | date : "M/d/yy" }}</span>
  </div>
  <button mat-button (click)="logout()">
    <mat-icon>logout</mat-icon>
    Logout
  </button>
</mat-toolbar>

<mat-drawer-container class="app-container">
  <mat-drawer #drawer mode="side" opened class="app-sidenav">
    <mat-nav-list>
      <a mat-list-item routerLink="/dashboard" routerLinkActive="active">
        <mat-icon matListItemIcon>dashboard</mat-icon>
        <span matListItemTitle>Dashboard</span>
      </a>
      <a mat-list-item routerLink="/tasks" routerLinkActive="active">
        <mat-icon matListItemIcon>assignment</mat-icon>
        <span matListItemTitle>Tasks</span>
      </a>
      <a
        *ngIf="currentRole === 'ADMIN' || currentRole === 'GUEST'"
        mat-list-item
        [routerLink]="currentRole === 'GUEST' ? null : '/users'"
        routerLinkActive="active"
        [class.disabled]="currentRole === 'GUEST'"
        (click)="currentRole === 'GUEST' && $event.preventDefault()"
      >
        <mat-icon matListItemIcon>people</mat-icon>
        <span matListItemTitle>Users</span>
      </a>
      <a
        *ngIf="currentRole === 'ADMIN' || currentRole === 'GUEST'"
        mat-list-item
        [routerLink]="currentRole === 'GUEST' ? null : '/dropdowns'"
        routerLinkActive="active"
        [class.disabled]="currentRole === 'GUEST'"
        (click)="currentRole === 'GUEST' && $event.preventDefault()"
      >
        <mat-icon matListItemIcon>list</mat-icon>
        <span matListItemTitle>Dropdowns</span>
      </a>
      <a 
        *ngIf="canAccessExpenses"
        mat-list-item 
        [routerLink]="currentRole === 'GUEST' ? null : '/expenses'" 
        routerLinkActive="active"
        [class.disabled]="currentRole === 'GUEST'"
        (click)="currentRole === 'GUEST' && $event.preventDefault()">
        <mat-icon matListItemIcon>receipt</mat-icon>
        <span matListItemTitle>Expenses</span>
      </a>
      <a mat-list-item routerLink="/reports" routerLinkActive="active">
        <mat-icon matListItemIcon>analytics</mat-icon>
        <span matListItemTitle>Analytics & Reports</span>
        <span matListItemLine class="coming-soon-subtitle">Time Analysis • Client Distribution • Trends</span>
      </a>
      <a 
        mat-list-item 
        href="/task-activity/list"
        (click)="navigateExternal($event, '/task-activity/list')">
        <mat-icon matListItemIcon>apps</mat-icon>
        <span matListItemTitle>Task Activity Tracker</span>
      </a>
      <a 
        *ngIf="currentRole !== 'GUEST' && canAccessExpenses"
        mat-list-item 
        href="/expenses/list"
        (click)="navigateExternal($event, '/expenses/list')">
        <mat-icon matListItemIcon>attach_money</mat-icon>
        <span matListItemTitle>Expense Tracker</span>
      </a>
      <a 
        *ngIf="currentRole === 'GUEST' && canAccessExpenses"
        mat-list-item
        class="disabled"
        (click)="$event.preventDefault()">
        <mat-icon matListItemIcon>attach_money</mat-icon>
        <span matListItemTitle>Expense Tracker</span>
      </a>
    </mat-nav-list>
  </mat-drawer>

  <mat-drawer-content>
    <router-outlet></router-outlet>
  </mat-drawer-content>
</mat-drawer-container>

